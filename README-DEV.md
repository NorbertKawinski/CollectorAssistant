
# Development
While you *can* use the build script mentioned in the README.MD for the regular development, it doesn\'t mean you *should*.

Regular development is much easier with:
- IDE
- Standalone application server
- Standalone database

## Database

### H2
For development purposes, you can use in-memory H2 database.
H2 database is preinstalled with WildFly so you don\'t have to install anything in here.
See WildFly setup section for more information

### MySQL
MySQL installation is pretty simple. Especially if using XAMPP (https://www.apachefriends.org/index.html) which also provides SQL administrator panel.

### Other databases
You can install pretty much any other database. It should work thanks to JPA standard.
For installation, please refer to specific vendor\'s instructions

## Application Server

### WildFly
This application is developed and tested using WildFly.
To install WildFly:

* Download appropriate package from the WildFly website (https://www.wildfly.org/)

* Add administrator (Management) user with **WildFly/bin/add-user.bat** script.

* Start the server using **WildFly/bin/standalone.bat** script.

* Either continue the following bullets 
  or execute the "install-local-wildfly.cmd" script (after tweaking paths in it)

* Enter http://localhost:8080/ and login as the previously created administrator

* Add datasource (Configuration -> Subsystems -> Datasources & Drivers)
	* name
	> MainDS
	* JNDI name
	> java:/collectorapp/datasources/MainDS
	* Connection URL for H2 (in-memory):
	> jdbc:h2:mem:TestDS;DB_CLOSE_DELAY=-1
	* Connection URL for H2 (file):
	> **TODO**
	* Connection URL for MySQL
	> jdbc:mysql://localhost:3306/collector_assistant?serverTimezone=UTC&useUnicode=yes&characterEncoding=UTF-8

* Configure log pattern in Configuration --> SubSystems --> Logging --> Configuration --> Formatter --> Pattern Formatter
	* Change COLOR-PATTERN:
	> %K{level}%d{HH:mm:ss,SSS} [%t] %5p %X{indent} %s%e{} o.o(%F:%L)%n

	This step is optional, but will greatly improve log readability.

* Shutdown the server
Configuration is complete.

### Other application servers
It should be possible to run the application on any server of your choice.
Please refer to appropriate documentation of your application server vendor.

## IDE

Personally, I\'m using the IntelliJ Idea, but you should be able to run the project with any IDE.

### IntelliJ Idea

You can instal IntelliJ Idea from https://www.jetbrains.com/idea/

Once installed, import the project using
> File --> New --> Project From Existing Sources

Then select the directory where the pom.xml file resides.
IntelliJ should automatically import the project from pom.xml

Once the project is imported, you should tick "Enable annotation processing" in IntelliJ settings.
Otherwise Lombok won\'t work properly.

Now you can add Run/Debug configuration for deploying code to the application server.
For WildFly you\'ll need to set:
* Administrator username
* Administrator password
* Select "collector-assistant:war exploded" as deployment for the server

You can now click on "Debug" button and voila. Alternativelly press "Shift+F9"

## Fast automatic testing
When we run the tests from Maven (or build.cmd), all tests are run. That\'s slow.
To make them faster we can:
* When running tests from build.cmd --> Keep the server always on to save on startup
	* To prevent build.cmd from starting the server, set "TEST_SERVER_STARTUP=MANUAL"
* Run only specific tests (that we are currently working on) from the IDE
	* **TODO: How to**
* Reuse browser session (Selenium) to save on browser startup for UI tests
	* **TODO: How to**

## Notes
* If you wonder what are classes like "Collection_", "User_" or "Category_" (with underscore "_" in them) --> These are classes automatically generated by "JPA metamodel" for typesafe SQL query generation.

* If you want to just build the application and then deploy it manually, you can find the collector-assistant.war file in "target/" directory after compilation. Now you can easily deploy that .war to any application server using its GUI (or any other supported deployment method).

